<!DOCTYPE html>
<html>
<head><title>Verify APIExercise Integration</title></head>
<body>
<h1>Verify APIExercise Integration</h1>
<button onclick="testList()">Test List Exercises</button>
<button onclick="testCreate()">Test Create Exercise</button>
<button onclick="clearLocalStorage()">Clear LocalStorage</button>
<div id="results" style="margin-top: 20px; padding: 10px; border: 1px solid #ccc;"></div>

<script type="module">
import { base44 } from '../../mock-sdk/index-browser.js';

window.testList = async function() {
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = 'Loading...';
    
    try {
        console.log('Testing Exercise.list()...');
        const exercises = await base44.entities.Exercise.list();
        console.log('Results:', exercises);
        
        resultsDiv.innerHTML = `
            <h3>✅ List Success!</h3>
            <p><strong>Total exercises:</strong> ${exercises.length}</p>
            <p><strong>Source:</strong> Check console logs to see if API or localStorage was used</p>
            <ul>
                ${exercises.slice(0, 3).map(ex => `<li>${ex.name} (ID: ${ex.id || ex._id})</li>`).join('')}
            </ul>
        `;
    } catch (error) {
        console.error('List failed:', error);
        resultsDiv.innerHTML = `<h3>❌ List Failed</h3><p>${error.message}</p>`;
    }
};

window.testCreate = async function() {
    const resultsDiv = document.getElementById('results');
    resultsDiv.innerHTML = 'Creating...';
    
    try {
        const newExercise = {
            name: 'Test Exercise ' + Date.now(),
            muscles: ['test'],
            discipline: ['test'],
            equipment: [],
            description: 'Created via API test'
        };
        
        console.log('Creating exercise:', newExercise);
        const created = await base44.entities.Exercise.create(newExercise);
        console.log('Created:', created);
        
        resultsDiv.innerHTML = `
            <h3>✅ Create Success!</h3>
            <p><strong>Name:</strong> ${created.name}</p>
            <p><strong>ID:</strong> ${created.id || created._id}</p>
            <p>Check console logs to see if API or localStorage was used</p>
        `;
    } catch (error) {
        console.error('Create failed:', error);
        resultsDiv.innerHTML = `<h3>❌ Create Failed</h3><p>${error.message}</p>`;
    }
};

window.clearLocalStorage = function() {
    const resultsDiv = document.getElementById('results');
    localStorage.removeItem('base44_Exercise');
    localStorage.removeItem('base44_data_version');
    resultsDiv.innerHTML = '<h3>LocalStorage cleared! Refresh the page to reinitialize.</h3>';
};

// Show initial state
document.getElementById('results').innerHTML = 'Click a button to test APIExercise functionality';
</script>
</body>
</html>